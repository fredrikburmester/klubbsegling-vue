import{A as L,_ as S,L as W,a as X,b as Y}from"./index.0e442c02.js";import{i as R,j as V,o as m,d as g,b as c,a as H,p as Z,F as N,e as U,t as B,r as F,v as ee,h as P,f as Q,w as te,c as z}from"./vendor.a0bddb9d.js";const re=async(o,r,e)=>new Promise(function(t,n){var a=JSON.parse(JSON.stringify(o));for(var s in a)if(a[s].id===r.id)return n("Du har redan den h\xE4r b\xE5ten."),!1;try{var i=[];o.length!==0&&(i=JSON.parse(JSON.stringify(o))),i.push(r);const l={Authorization:`Bearer ${localStorage.getItem("jwt")}`},u={boats:i};R.put(`${L}/users/${e.id}`,u,{headers:l}).then(f=>{t(r)}).catch(f=>{n("N\xE5gonting gick snett.")})}catch{n("N\xE5gonting gick snett.")}}),ae={name:"AddBoatForm",props:{userboats:{type:Array,required:!0}},emits:["boats"],data(){return{userBoats:this.userboats,allBoats:[],selectedBoat:"",me:this.$store.getters.getProfile}},async mounted(){try{const o=await R.get(`${L}/boats`,{headers:{Authorization:`Bearer ${localStorage.getItem("jwt")}`}});this.allBoats=o.data,this.selectedBoat=this.allBoats[0]}catch{}},methods:{addBoat(){re(this.userBoats,this.selectedBoat,this.me).then(o=>{V(`${o.name} tillagd!`,{type:"success",timeout:3e3,position:"top-right"}),this.$emit("newBoat",o)}).catch(o=>{V(o,{type:"danger",timeout:3e3,position:"top-right"})})}}},ne={class:"flex space-x-4 mb-4 m-0"},oe=c("label",{for:"register-modal",class:"btn btn-primary text-base-content modal-button"}," L\xE4gg till b\xE5t ",-1),se=c("input",{id:"register-modal",type:"checkbox",class:"modal-toggle"},null,-1),ie={class:"modal m-0"},le={class:"modal-box m-0"},ce=c("p",null,"V\xE4lj b\xE5t att l\xE4gga till:",-1),de=c("option",{disabled:"",value:"V\xE4lj b\xE5t"},"V\xE4lj b\xE5t",-1),ue=["value"],fe={class:"modal-action flex justify-start"},pe=c("label",{for:"register-modal",class:"btn"},"Avbryt",-1);function me(o,r,e,t,n,a){return m(),g("div",ne,[oe,se,c("div",ie,[c("div",le,[ce,c("div",null,[H(c("select",{"onUpdate:modelValue":r[0]||(r[0]=s=>n.selectedBoat=s),class:"select select-bordered select w-full max-w-xs mt-4"},[de,(m(!0),g(N,null,U(n.allBoats,s=>(m(),g("option",{key:s.id,value:s},B(s.name),9,ue))),128))],512),[[Z,n.selectedBoat]])]),c("div",fe,[c("label",{for:"register-modal",class:"btn btn-primary",onClick:r[1]||(r[1]=(...s)=>a.addBoat&&a.addBoat(...s))},"L\xE4gg till"),pe])])])])}var he=S(ae,[["render",me]]),D=Object.prototype.hasOwnProperty,_=function(){for(var o=[],r=0;r<256;++r)o.push("%"+((r<16?"0":"")+r.toString(16)).toUpperCase());return o}(),ve=function(r){for(var e;r.length;){var t=r.pop();if(e=t.obj[t.prop],Array.isArray(e)){for(var n=[],a=0;a<e.length;++a)typeof e[a]!="undefined"&&n.push(e[a]);t.obj[t.prop]=n}}return e},J=function(r,e){for(var t=e&&e.plainObjects?Object.create(null):{},n=0;n<r.length;++n)typeof r[n]!="undefined"&&(t[n]=r[n]);return t},ye=function o(r,e,t){if(!e)return r;if(typeof e!="object"){if(Array.isArray(r))r.push(e);else if(typeof r=="object")(t.plainObjects||t.allowPrototypes||!D.call(Object.prototype,e))&&(r[e]=!0);else return[r,e];return r}if(typeof r!="object")return[r].concat(e);var n=r;return Array.isArray(r)&&!Array.isArray(e)&&(n=J(r,t)),Array.isArray(r)&&Array.isArray(e)?(e.forEach(function(a,s){D.call(r,s)?r[s]&&typeof r[s]=="object"?r[s]=o(r[s],a,t):r.push(a):r[s]=a}),r):Object.keys(e).reduce(function(a,s){var i=e[s];return D.call(a,s)?a[s]=o(a[s],i,t):a[s]=i,a},n)},ge=function(r,e){return Object.keys(e).reduce(function(t,n){return t[n]=e[n],t},r)},be=function(o){try{return decodeURIComponent(o.replace(/\+/g," "))}catch{return o}},_e=function(r){if(r.length===0)return r;for(var e=typeof r=="string"?r:String(r),t="",n=0;n<e.length;++n){var a=e.charCodeAt(n);if(a===45||a===46||a===95||a===126||a>=48&&a<=57||a>=65&&a<=90||a>=97&&a<=122){t+=e.charAt(n);continue}if(a<128){t=t+_[a];continue}if(a<2048){t=t+(_[192|a>>6]+_[128|a&63]);continue}if(a<55296||a>=57344){t=t+(_[224|a>>12]+_[128|a>>6&63]+_[128|a&63]);continue}n+=1,a=65536+((a&1023)<<10|e.charCodeAt(n)&1023),t+=_[240|a>>18]+_[128|a>>12&63]+_[128|a>>6&63]+_[128|a&63]}return t},xe=function(r){for(var e=[{obj:{o:r},prop:"o"}],t=[],n=0;n<e.length;++n)for(var a=e[n],s=a.obj[a.prop],i=Object.keys(s),l=0;l<i.length;++l){var u=i[l],f=s[u];typeof f=="object"&&f!==null&&t.indexOf(f)===-1&&(e.push({obj:s,prop:u}),t.push(f))}return ve(e)},we=function(r){return Object.prototype.toString.call(r)==="[object RegExp]"},Oe=function(r){return r===null||typeof r=="undefined"?!1:!!(r.constructor&&r.constructor.isBuffer&&r.constructor.isBuffer(r))},M={arrayToObject:J,assign:ge,compact:xe,decode:be,encode:_e,isBuffer:Oe,isRegExp:we,merge:ye},je=String.prototype.replace,Be=/%20/g,q={default:"RFC3986",formatters:{RFC1738:function(o){return je.call(o,Be,"+")},RFC3986:function(o){return o}},RFC1738:"RFC1738",RFC3986:"RFC3986"},I=M,E=q,G={brackets:function(r){return r+"[]"},indices:function(r,e){return r+"["+e+"]"},repeat:function(r){return r}},Ae=Date.prototype.toISOString,x={delimiter:"&",encode:!0,encoder:I.encode,encodeValuesOnly:!1,serializeDate:function(r){return Ae.call(r)},skipNulls:!1,strictNullHandling:!1},Le=function o(r,e,t,n,a,s,i,l,u,f,p,y){var d=r;if(typeof i=="function")d=i(e,d);else if(d instanceof Date)d=f(d);else if(d===null){if(n)return s&&!y?s(e,x.encoder):e;d=""}if(typeof d=="string"||typeof d=="number"||typeof d=="boolean"||I.isBuffer(d)){if(s){var w=y?e:s(e,x.encoder);return[p(w)+"="+p(s(d,x.encoder))]}return[p(e)+"="+p(String(d))]}var h=[];if(typeof d=="undefined")return h;var O;if(Array.isArray(i))O=i;else{var j=Object.keys(d);O=l?j.sort(l):j}for(var A=0;A<O.length;++A){var b=O[A];a&&d[b]===null||(Array.isArray(d)?h=h.concat(o(d[b],t(e,b),t,n,a,s,i,l,u,f,p,y)):h=h.concat(o(d[b],e+(u?"."+b:"["+b+"]"),t,n,a,s,i,l,u,f,p,y)))}return h},$e=function(o,r){var e=o,t=r?I.assign({},r):{};if(t.encoder!==null&&t.encoder!==void 0&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");var n=typeof t.delimiter=="undefined"?x.delimiter:t.delimiter,a=typeof t.strictNullHandling=="boolean"?t.strictNullHandling:x.strictNullHandling,s=typeof t.skipNulls=="boolean"?t.skipNulls:x.skipNulls,i=typeof t.encode=="boolean"?t.encode:x.encode,l=typeof t.encoder=="function"?t.encoder:x.encoder,u=typeof t.sort=="function"?t.sort:null,f=typeof t.allowDots=="undefined"?!1:t.allowDots,p=typeof t.serializeDate=="function"?t.serializeDate:x.serializeDate,y=typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:x.encodeValuesOnly;if(typeof t.format=="undefined")t.format=E.default;else if(!Object.prototype.hasOwnProperty.call(E.formatters,t.format))throw new TypeError("Unknown format option provided.");var d=E.formatters[t.format],w,h;typeof t.filter=="function"?(h=t.filter,e=h("",e)):Array.isArray(t.filter)&&(h=t.filter,w=h);var O=[];if(typeof e!="object"||e===null)return"";var j;t.arrayFormat in G?j=t.arrayFormat:"indices"in t?j=t.indices?"indices":"repeat":j="indices";var A=G[j];w||(w=Object.keys(e)),u&&w.sort(u);for(var b=0;b<w.length;++b){var C=w[b];s&&e[C]===null||(O=O.concat(Le(e[C],C,A,a,s,i?l:null,h,u,f,p,d,y)))}var T=O.join(n),K=t.addQueryPrefix===!0?"?":"";return T.length>0?K+T:""},$=M,k=Object.prototype.hasOwnProperty,v={allowDots:!1,allowPrototypes:!1,arrayLimit:20,decoder:$.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:!1,strictNullHandling:!1},Ne=function(r,e){for(var t={},n=e.ignoreQueryPrefix?r.replace(/^\?/,""):r,a=e.parameterLimit===1/0?void 0:e.parameterLimit,s=n.split(e.delimiter,a),i=0;i<s.length;++i){var l=s[i],u=l.indexOf("]="),f=u===-1?l.indexOf("="):u+1,p,y;f===-1?(p=e.decoder(l,v.decoder),y=e.strictNullHandling?null:""):(p=e.decoder(l.slice(0,f),v.decoder),y=e.decoder(l.slice(f+1),v.decoder)),k.call(t,p)?t[p]=[].concat(t[p]).concat(y):t[p]=y}return t},Fe=function(o,r,e){for(var t=r,n=o.length-1;n>=0;--n){var a,s=o[n];if(s==="[]")a=[],a=a.concat(t);else{a=e.plainObjects?Object.create(null):{};var i=s.charAt(0)==="["&&s.charAt(s.length-1)==="]"?s.slice(1,-1):s,l=parseInt(i,10);!isNaN(l)&&s!==i&&String(l)===i&&l>=0&&e.parseArrays&&l<=e.arrayLimit?(a=[],a[l]=t):a[i]=t}t=a}return t},Pe=function(r,e,t){if(!!r){var n=t.allowDots?r.replace(/\.([^.[]+)/g,"[$1]"):r,a=/(\[[^[\]]*])/,s=/(\[[^[\]]*])/g,i=a.exec(n),l=i?n.slice(0,i.index):n,u=[];if(l){if(!t.plainObjects&&k.call(Object.prototype,l)&&!t.allowPrototypes)return;u.push(l)}for(var f=0;(i=s.exec(n))!==null&&f<t.depth;){if(f+=1,!t.plainObjects&&k.call(Object.prototype,i[1].slice(1,-1))&&!t.allowPrototypes)return;u.push(i[1])}return i&&u.push("["+n.slice(i.index)+"]"),Fe(u,e,t)}},Ce=function(o,r){var e=r?$.assign({},r):{};if(e.decoder!==null&&e.decoder!==void 0&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(e.ignoreQueryPrefix=e.ignoreQueryPrefix===!0,e.delimiter=typeof e.delimiter=="string"||$.isRegExp(e.delimiter)?e.delimiter:v.delimiter,e.depth=typeof e.depth=="number"?e.depth:v.depth,e.arrayLimit=typeof e.arrayLimit=="number"?e.arrayLimit:v.arrayLimit,e.parseArrays=e.parseArrays!==!1,e.decoder=typeof e.decoder=="function"?e.decoder:v.decoder,e.allowDots=typeof e.allowDots=="boolean"?e.allowDots:v.allowDots,e.plainObjects=typeof e.plainObjects=="boolean"?e.plainObjects:v.plainObjects,e.allowPrototypes=typeof e.allowPrototypes=="boolean"?e.allowPrototypes:v.allowPrototypes,e.parameterLimit=typeof e.parameterLimit=="number"?e.parameterLimit:v.parameterLimit,e.strictNullHandling=typeof e.strictNullHandling=="boolean"?e.strictNullHandling:v.strictNullHandling,o===""||o===null||typeof o=="undefined")return e.plainObjects?Object.create(null):{};for(var t=typeof o=="string"?Ne(o,e):o,n=e.plainObjects?Object.create(null):{},a=Object.keys(t),s=0;s<a.length;++s){var i=a[s],l=Pe(i,t[i],e);n=$.merge(n,l,e)}return $.compact(n)},Se=$e,De=Ce,Ie=q,Ee={formats:Ie,parse:De,stringify:Se};const ke={name:"Profile",components:{LoadingCard:W},props:{boat:{type:Object,required:!0,default:()=>{}}},data(){return{hasImage:!!this.boat.image,imageLoaded:!1}},computed:{thumbnail(){return L+this.boat.image.formats.small.url}},mounted(){console.log(this.boat),console.log(this.hasImages)},methods:{onImgLoad(){this.imageLoaded=!0}}},Te={class:"border border-blue-300 card shadow-xl image-full mt-4 h-94"},Re={key:0},Ve=["src"],He={class:"justify-end card-body h-56"},Ue={class:"card-title"},Qe={key:0,class:"max-h-12 overflow-hidden"},ze=c("div",{class:"card-actions"},[c("button",{class:"btn btn-primary"},"Mer info")],-1);function Je(o,r,e,t,n,a){const s=F("router-link"),i=F("LoadingCard");return m(),g(N,null,[H(c("div",Te,[n.hasImage?(m(),g("figure",Re,[c("img",{src:a.thumbnail,onLoad:r[0]||(r[0]=(...l)=>a.onImgLoad&&a.onImgLoad(...l))},null,40,Ve)])):P("",!0),c("div",He,[c("h2",Ue,B(e.boat.name),1),e.boat.owner?(m(),g("p",Qe,B(e.boat.owner.name),1)):P("",!0),Q(s,{to:`/profile/boat/${e.boat.id}`},{default:te(()=>[ze]),_:1},8,["to"])])],512),[[ee,!n.hasImage||n.imageLoaded]]),!n.imageLoaded&&n.hasImage?(m(),z(i,{key:0})):P("",!0)],64)}var Me=S(ke,[["render",Je]]);const qe={components:{AddBoatForm:he,BoatCard:Me},data(){return{me:this.$store.getters.getProfile,loading:!0,userBoats:[],imageLoading:!0}},computed:{profilePicture(){return this.me.image?L+this.me.image.formats.small.url:null}},mounted(){const o=Ee.stringify({_where:{_or:[[{"sailors.id":this.me.id}],[{"owner.id":this.me.id}]]}});X("boats",null,o,this.me.id).then(r=>{this.userBoats=r,this.loading=!1})},methods:{logout:function(){this.$store.dispatch(Y).then(()=>{this.$route.params.nextUrl!=null?this.$router.push(this.$route.params.nextUrl):this.$router.push("/")})},onNewBoat(o){this.userBoats.push(o)},getOwnerName(o){return o.owner?o.owner.name:"No owner"},getBoatImage(o){return o.image?`${L}${o.image.url}`:(this.imageLoading=!1,null)},imageLoaded(){this.imageLoading=!1}}},Ge={key:0,class:"wrapper md:max-w-2xl justify-self-center grid px-6"},Ke={key:0,class:"avatar px-6 pt-12 justify-self-center"},We={class:"mb-8 rounded-full w-32 h-32"},Xe=["src"],Ye={key:1,class:"avatar placeholder px-6 pt-12 justify-self-center"},Ze={class:"bg-neutral-focus text-neutral-content rounded-full w-32 h-32"},et={class:"text-3xl"},tt={class:"card-title text-2xl text-center mt-4"},rt={class:"text-center"},at=c("h1",{class:"mt-4 font-bold"},"Mina B\xE5tar",-1);function nt(o,r,e,t,n,a){const s=F("BoatCard"),i=F("AddBoatForm");return m(),g(N,null,[n.loading?P("",!0):(m(),g("div",Ge,[a.profilePicture?(m(),g("div",Ke,[c("div",We,[c("img",{src:a.profilePicture},null,8,Xe)])])):(m(),g("div",Ye,[c("div",Ze,[c("span",et,B(n.me.name[0]),1)])])),c("h2",tt,B(n.me.name),1),c("p",rt,B(n.me.about||null),1),at,(m(!0),g(N,null,U(n.userBoats,l=>(m(),z(s,{key:l.id,boat:l},null,8,["boat"]))),128)),Q(i,{class:"mt-4",userboats:n.userBoats,onNewBoat:a.onNewBoat},null,8,["userboats","onNewBoat"])])),c("button",{id:"logout",class:"btn btn-error mb-6 mt-12 w-48 ml-auto mr-auto",onClick:r[0]||(r[0]=(...l)=>a.logout&&a.logout(...l))}," Logga ut ")],64)}var it=S(qe,[["render",nt]]);export{it as default};
